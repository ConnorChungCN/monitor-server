syntax = "proto3";
// 包名
package monitor;
// 生成的go文件位置及其包名
option go_package = "hanglok-tech.com/monitor-server/adapter/grpc/proto/monitor;monitor";

message TaskInfo {
    CPUState cpu_state = 1;
    MemoryState memory_state = 2;
    GPUInfo gpu_state = 3;
}

message CPUState {
    float cpu_percent = 1;
}

message MemoryState {
    uint64 memory_used = 1;
    uint64 memory_max_used = 2;
}

message GPUState {
    string cuda_version = 1;
    string attached_gpus = 2;
    repeated GPUInfo gpus_info = 3;
}

message GPUInfo {
    string product_name = 1;
    float memory_total = 2;
    float memory_used = 3;
    float memory_free = 4;
    float gpu_usage = 5;
    float memory_usage = 6;
}

message FindTaskInfoByIdReq {
    string task_id = 1;
}

// message FindTaskInfoByIdRsp {
//     TaskInfo task_info = 1;
// }

message FindTaskInfoByIdRsp {
    float AvgCPUPercent = 1;
    uint64 AvgMemoryUsed = 2;
    uint64 AvgMemoryMaxUsed = 3;
}

service monitor {
    rpc FindTaskInfoById(FindTaskInfoByIdReq) returns (FindTaskInfoByIdRsp);
}